# UI ‚Äî –ø–æ–Ω—è—Ç–Ω—ã–º —è–∑—ã–∫–æ–º (–¥–ª—è `CarSharing`) ‚ù§Ô∏è

–≠—Ç–æ—Ç —Ñ–∞–π–ª –æ–±—ä—è—Å–Ω—è–µ—Ç –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–∞ UI-—á–∞—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞: **`MainActivity`**, `Fragments`, `ViewModel`, `Adapters`, `BottomSheet` –∏ –∫–∞–∫ –≤—Å—ë –º–µ–∂–¥—É —Å–æ–±–æ–π –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç. –¶–µ–ª—å ‚Äî —á—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏ –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É –∫–æ–¥ —É—Å—Ç—Ä–æ–µ–Ω —Ç–∞–∫, –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω, –∏ –∫–∞–∫ –¥–æ–±–∞–≤–ª—è—Ç—å –∏–ª–∏ –ø—Ä–∞–≤–∏—Ç—å —ç–∫—Ä–∞–Ω—ã –Ω–∞ Kotlin.

---

## –ö–æ—Ä–æ—Ç–∫–∞—è —Å—Ö–µ–º–∞ –ø–æ—Ç–æ–∫–∞ (—Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è) üîÅ

User action ‚Üí Fragment (View) ‚Üí ViewModel (–ª–æ–≥–∏–∫–∞, —Å–æ—Å—Ç–æ—è–Ω–∏–µ) ‚Üí Repository ‚Üí ApiService ‚Üí Network

–û—Ç–≤–µ—Ç –∏–¥—ë—Ç –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ: Network ‚Üí ApiService ‚Üí Repository ‚Üí ViewModel ‚Üí Fragment ‚Üí UI update

> –ó–∞–ø–æ–º–Ω–∏—Ç–µ: Fragment ‚Äî —Ç–æ–ª—å–∫–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ —Å–æ–±—ã—Ç–∏—è, ViewModel ‚Äî –ª–æ–≥–∏–∫–∞ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.

---

## MainActivity ‚Äî ¬´—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞¬ª –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è üß≠

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–æ–ª–∏:**
- –•–æ—Å—Ç–∏—Ç `NavHostFragment` –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç `NavController` (–Ω–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏).
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç `BottomNavigationView` –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç/—Å–∫—Ä—ã–≤–∞–µ—Ç –µ–≥–æ –¥–ª—è –Ω—É–∂–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤.
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–∫–µ–Ω –∏–∑ `TokenManager` –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∏ –ø—Ä–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ `RetrofitClient.authToken` (—á—Ç–æ–±—ã –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã —à–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏).
- –í—ã–ø–æ–ª–Ω—è–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –≤–µ—â–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞–≤–µ–¥–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è UI –ø—Ä–∏ —Å–º–µ–Ω–µ destination).

**–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ (–∏–¥–µ–∏):**

```kotlin
val navHostFragment = supportFragmentManager
  .findFragmentById(R.id.nav_host_fragment) as NavHostFragment
val navController = navHostFragment.navController
bottomNavigation.setupWithNavController(navController)

navController.addOnDestinationChangedListener { _, destination, _ ->
  when (destination.id) {
    R.id.loginFragment -> bottomNavigation.visibility = View.GONE
    else -> bottomNavigation.visibility = View.VISIBLE
  }
}
```

**–ü–æ—á–µ–º—É —Ç–∞–∫:**
- `MainActivity` –∂–∏–≤—ë—Ç –¥–æ–ª—å—à–µ —ç–∫—Ä–∞–Ω–æ–≤ –∏ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏ (–Ω–∞–≤–∏–≥–∞—Ü–∏—è, –≥–ª–æ–±–∞–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–æ–≤ –∏ —Ç.–ø.).

### –ü–æ—è—Å–Ω–µ–Ω–∏–µ: `override fun onCreate(savedInstanceState: Bundle?)` ‚Äî —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏ –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è
`onCreate` ‚Äî –ø–µ—Ä–≤–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ Activity –ø—Ä–∏ –µ—ë —Å–æ–∑–¥–∞–Ω–∏–∏ (–ø–æ—Å–ª–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞). –í–æ—Ç —á—Ç–æ –≤–∞–∂–Ω–æ –∑–Ω–∞—Ç—å –∏ –ø–æ—á–µ–º—É:

- –í—ã–∑–æ–≤ `super.onCreate(savedInstanceState)` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω: —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é Activity –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.
- `setContentView(R.layout.activity_main)` —Å–≤—è–∑—ã–≤–∞–µ—Ç XML-layout —Å Activity; –ª—é–±—ã–µ `findViewById` –∏–ª–∏ View Binding –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ.
- `savedInstanceState` —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∞–ª–µ–Ω—å–∫–∏–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ Activity —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞ –≤ `onSaveInstanceState` (–Ω–µ –ø—É—Ç–∞—Ç—å —Å ViewModel/SavedStateHandle). –û–Ω –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è UI (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å–∫—Ä–æ–ª–ª–∞, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–ª–∞–≥–∏) –ø–æ—Å–ª–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞.

–ü—Ä–∏–º–µ—Ä —Ç–∏–ø–∏—á–Ω–æ–≥–æ `onCreate` –∏–∑ —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:
```kotlin
override fun onCreate(savedInstanceState: Bundle?) {
  super.onCreate(savedInstanceState)
  setContentView(R.layout.activity_main)

  tokenManager = TokenManager(this)

  val navHostFragment = supportFragmentManager
      .findFragmentById(R.id.nav_host_fragment) as NavHostFragment
  navController = navHostFragment.navController

  bottomNavigation = findViewById(R.id.bottomNavigation)
  bottomNavigation.setupWithNavController(navController)

  // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–∫–µ–Ω –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –≤ Retrofit
  lifecycleScope.launch {
    val token = tokenManager.getToken().first()
    if (token != null) {
      RetrofitClient.authToken = token
    }
  }

  navController.addOnDestinationChangedListener { _, destination, _ ->
    // –°–∫—Ä—ã–≤–∞–µ–º bottom nav –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —ç–∫—Ä–∞–Ω–∞—Ö
  }
}
```

–°–æ–≤–µ—Ç—ã –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:
- –î–µ—Ä–∂–∏—Ç–µ `onCreate` ¬´—Ç–æ–Ω–∫–∏–º¬ª: —Ç–æ–ª—å–∫–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è view, –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ –≤—ã–∑–æ–≤—ã. –î–æ–ª–≥–∏–µ/–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –≤ –∫–æ—Ä—É—Ç–∏–Ω–∞—Ö –∏–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç–µ –≤ ViewModel.
- –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ª–æ–∂–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π—Ç–µ `SavedStateHandle` –≤–Ω—É—Ç—Ä–∏ ViewModel ‚Äî —ç—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã–º –∏ —É—Å—Ç–æ–π—á–∏–≤—ã–º –∫ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è–º.
- –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –æ—á–µ–Ω—å –º–∞–ª–æ–≥–æ –æ–±—ä—ë–º–∞ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–∑–∏—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞) –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `onSaveInstanceState` / `savedInstanceState`.
- –ù–µ –≤—ã–∑—ã–≤–∞–π—Ç–µ UI-–æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ `setContentView` (–∏–Ω–∞—á–µ –ø–æ–ª—É—á–∏—Ç–µ NPE).
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ–∂–¥–∞—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è UI ‚Äî –ø–æ–∫–∞–∂–∏—Ç–µ `loading` state –∏ –æ–±–Ω–æ–≤–∏—Ç–µ UI –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

---

## Fragments ‚Äî —á—Ç–æ –æ–Ω–∏ –¥–µ–ª–∞—é—Ç (–∏ —á–µ–≥–æ –Ω–µ –¥–æ–ª–∂–Ω—ã –¥–µ–ª–∞—Ç—å) üñºÔ∏è

**–ß—Ç–æ –¥–µ–ª–∞—é—Ç:**
- Inflate layout –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç View Binding.
- –°–ª—É—à–∞—é—Ç —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫–Ω–æ–ø–∫–∏, –≤–≤–æ–¥, –ª–∏—Å—Ç–∞–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤).
- –í—ã–∑—ã–≤–∞—é—Ç –º–µ—Ç–æ–¥—ã ViewModel –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `viewModel.login()` –∏–ª–∏ `viewModel.loadCars()`).
- –ü–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –Ω–∞ `StateFlow`/`LiveData` –∏–∑ ViewModel –∏ –æ–±–Ω–æ–≤–ª—è—é—Ç UI (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–ø–∏—Å–æ–∫, —Å–ø–∏–Ω–Ω–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏).

**–ß–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å –≤ Fragment:**
- –ù–µ –¥–µ—Ä–∂–∏—Ç–µ —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É —Ç—É—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, —Å–µ—Ç–µ–≤—ã–µ –≤—ã–∑–æ–≤—ã). –≠—Ç–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å ViewModel.
- –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ Context –∏–ª–∏ View (–æ—Å–≤–æ–±–æ–∂–¥–∞–π—Ç–µ binding –≤ `onDestroyView`).

**–ü—Ä–∏–º–µ—Ä (LoginFragment):**
- –ü–æ–ª—É—á–∞–µ—Ç username/password ‚Üí –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `viewModel.login(username, password)`.
- –ù–∞–±–ª—é–¥–∞–µ—Ç `viewModel.loginResult` –∏ –ø—Ä–∏ —É—Å–ø–µ—Ö–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `TokenManager` –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ `CatalogueFragment`.

---

## ViewModel ‚Äî ¬´–º–æ–∑–≥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞¬ª üß†

**–ó–∞—á–µ–º –Ω—É–∂–µ–Ω:**
- –•—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `Loading`, `Success(data)`, `Error(message)`).
- –í—ã–ø–æ–ª–Ω—è–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É –≤ `viewModelScope` (–≤—ã–∑–æ–≤—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è).
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `SavedStateHandle`, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ø–æ–≤–æ—Ä–æ—Ç–µ —ç–∫—Ä–∞–Ω–∞.

**–¢–∏–ø–∏—á–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:**
- `MutableStateFlow` + `StateFlow` –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö ViewModel.
- `LiveData` –∏–Ω–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.
- Sealed-–∫–ª–∞—Å—Å—ã (`Loading`, `Success`, `Error`) ‚Äî —É–¥–æ–±–Ω—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ UI.

**–ü—Ä–∏–º–µ—Ä:**
```kotlin
sealed class CatalogueUiState {
  object Loading : CatalogueUiState()
  data class Success(val cars: List<CarListItemResponse>) : CatalogueUiState()
  data class Error(val message: String) : CatalogueUiState()
}
```

**–í–∞–∂–Ω–æ:** ViewModel –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å –æ View (Fragment). –û–Ω –ø—Ä–æ—Å—Ç–æ –¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –∫–æ–º–∞–Ω–¥—ã.

---

## –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ Fragment ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± üîÑ

–ß—Ç–æ–±—ã –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –∫–æ–≥–¥–∞ —ç–∫—Ä–∞–Ω –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `repeatOnLifecycle`:

```kotlin
lifecycleScope.launch {
  viewLifecycleOwner.lifecycle.repeatOnLifecycle(Lifecycle.State.STARTED) {
    viewModel.uiState.collect { state -> render(state) }
  }
}
```

–≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É—Ç–µ—á–∫–∏ –∏ –ª–∏—à–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –∫–æ–≥–¥–∞ Fragment –≤ —Ñ–æ–Ω–µ.

---

## Adapters –∏ RecyclerView ‚Äî –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ üìã

**–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è:**
- –ò—Å–ø–æ–ª—å–∑—É–µ–º `ListAdapter` + `DiffUtil` –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞.
- `ViewHolder` —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–æ–¥ `bind(item)` ‚Äî —Ç—É–¥–∞ –ø–æ–º–µ—â–∞–µ–º –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é view (–Ω–∞–∑–≤–∞–Ω–∏–µ, –∫–∞—Ä—Ç–∏–Ω–∫–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤).

**–ü—Ä–∏–º–µ—Ä:** `CarAdapter(onItemClick: (Long) -> Unit)`
- –í `bind` –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –±—Ä–µ–Ω–¥, –º–æ–¥–µ–ª—å, —Ü–µ–Ω—É, –∫–∞—Ä—Ç–∏–Ω–∫—É –∏ –Ω–∞–≤–µ—à–∏–≤–∞–µ–º `setOnClickListener { onItemClick(car.id) }`.

**–ü–æ—á–µ–º—É ListAdapter:**
- –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—á–∏—Ç–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å ‚Äî –±—ã—Å—Ç—Ä–µ–µ –∏ –ø–ª–∞–≤–Ω–µ–µ.

---

## BottomSheet (Filters) ‚Äî –∫–∞–∫ –æ–Ω –æ–±—â–∞–µ—Ç—Å—è —Å —ç–∫—Ä–∞–Ω–æ–º üóÇÔ∏è

–î–≤–µ –æ–ø—Ü–∏–∏:
1. –ü–µ—Ä–µ–¥–∞—Ç—å —Ç–µ–∫—É—â–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç—ã (`bundle`) –∏ –≤–µ—Ä–Ω—É—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ callback.
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `activityViewModels()` ‚Äî –æ–±—â—É—é ViewModel –º–µ–∂–¥—É `CatalogueFragment` –∏ `FiltersBottomSheet`.

**–í –ø—Ä–æ–µ–∫—Ç–µ:** `FiltersBottomSheet` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–∏–±–æ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –ª–∏–±–æ –æ–±—â—É—é –º–æ–¥–µ–ª—å, —á—Ç–æ–±—ã –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å –æ–ø—Ü–∏–∏ –∏–∑ `CatalogueViewModel` –∏ –≤–µ—Ä–Ω—É—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –Ω–∞–∑–∞–¥.

---

## SavedStateHandle ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –ø–æ–≤–æ—Ä–æ—Ç–µ üîê

`SavedStateHandle` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –º–∞–ª–µ–Ω—å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (—Ñ–∏–ª—å—Ç—Ä—ã, –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–∞—Ç—ã) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ ViewModel:
```kotlin
private val _filters = MutableStateFlow(savedStateHandle.get<CatalogueFilters>(KEY_FILTERS) ?: CatalogueFilters())
// –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
savedStateHandle[KEY_FILTERS] = newFilters
```

–≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–æ—Ç–µ—Ä–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞.

---

## –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª + –ö–æ—Ä–æ—É—Ç–∏–Ω—ã ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ‚õëÔ∏è

- –°–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ `viewModelScope` ‚Äî –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏ ViewModel –æ–Ω–∏ –æ—Ç–º–µ–Ω—è—é—Ç—Å—è.
- –ü–æ–¥–ø–∏—Å–∫–∏ –≤ Fragment ‚Äî —á–µ—Ä–µ–∑ `lifecycleScope` + `repeatOnLifecycle`.
- –ù–µ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ —Ç—è–∂—ë–ª—É—é —Ä–∞–±–æ—Ç—É –Ω–∞ –≥–ª–∞–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ.

---

## –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —ç–∫—Ä–∞–Ω ‚Äî —à–∞–≥–∏ –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ üõ†Ô∏è

1. –°–æ–∑–¥–∞–π—Ç–µ layout XML –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ binding.
2. –°–æ–∑–¥–∞–π—Ç–µ Fragment, –∏–Ω—Ñ–ª–µ–π—Ç–∏—Ç–µ binding, –æ—Å–≤–æ–±–æ–¥–∏—Ç–µ –µ–≥–æ –≤ `onDestroyView`.
3. –°–æ–∑–¥–∞–π—Ç–µ ViewModel (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω state) –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ `StateFlow`/`LiveData`.
4. –î–æ–±–∞–≤—å—Ç–µ destination –≤ `nav_graph.xml`.
5. –ï—Å–ª–∏ –Ω—É–∂–µ–Ω —Å–µ—Ç–µ–≤–æ–π –≤—ã–∑–æ–≤ ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –º–µ—Ç–æ–¥ –≤ `ApiService` –∏ wrapper –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.
6. –í Fragment –ø–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ `uiState` –∏ –≤—ã–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ.
7. –ù–∞–ø–∏—à–∏—Ç–µ Adapter, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω —Å–ø–∏—Å–æ–∫, –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ.

---

## –ß–∞—Å—Ç—ã–µ –±–∞–≥–∏ –∏ –∫–∞–∫ –∏—Ö —Ñ–∏–∫—Å–∏—Ç—å üêû

- –ü—Ä–æ–±–ª–µ–º–∞: **–Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞** ‚Äî —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —Ç–æ–∫–µ–Ω –Ω–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω –∏–ª–∏ `RetrofitClient.authToken` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TokenManager.saveToken()` –∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ `RetrofitClient.authToken`.
- –ü—Ä–æ–±–ª–µ–º–∞: **NPE –≤ binding** ‚Äî –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ `_binding = null` –≤ `onDestroyView()`.
- –ü—Ä–æ–±–ª–µ–º–∞: **–ø–æ—Ç–µ—Ä—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –ø–æ–≤–æ—Ä–æ—Ç–µ** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `SavedStateHandle`.
- –î–ª—è –¥–µ–±–∞–≥–∞ —Å–µ—Ç–∏ ‚Äî –≤–∫–ª—é—á–∏—Ç–µ `HttpLoggingInterceptor` (—É –≤–∞—Å –æ–Ω —É–∂–µ –≤–∫–ª—é—á—ë–Ω –Ω–∞ BODY).

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ—Ä–æ—Ç–∫–∏–µ —à–∞–±–ª–æ–Ω—ã (Kotlin) ‚úÇÔ∏è

**StateFlow –ø–æ–¥–ø–∏—Å–∫–∞:**
```kotlin
lifecycleScope.launch {
  viewLifecycleOwner.lifecycle.repeatOnLifecycle(Lifecycle.State.STARTED) {
    viewModel.uiState.collect { state -> render(state) }
  }
}
```

**–í—ã–∑–æ–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤ ViewModel:**
```kotlin
fun loadCars() = viewModelScope.launch {
  _uiState.value = CatalogueUiState.Loading
  val resp = repository.getCatalogue(page = 0)
  if (resp.isSuccessful) _uiState.value = CatalogueUiState.Success(resp.body()?.content ?: emptyList())
  else _uiState.value = CatalogueUiState.Error("–û—à–∏–±–∫–∞: ${resp.code()}")
}
```

**–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ savedStateHandle:**
```kotlin
savedStateHandle[KEY_FILTERS] = filters
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ ‚ù§Ô∏è

–ï—Å–ª–∏ –≤—ã –∑–∞–ø–æ–º–Ω–∏—Ç–µ:
- Fragment = UI –∏ —Å–æ–±—ã—Ç–∏—è;
- ViewModel = —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –ª–æ–≥–∏–∫–∞;
- Repository = –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º;
- MainActivity = –Ω–∞–≤–∏–≥–∞—Ü–∏—è & –≥–ª–æ–±–∞–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî

—Ç–æ –≤—ã –±—É–¥–µ—Ç–µ —É–≤–µ—Ä–µ–Ω–Ω–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ UI-—á–∞—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç–µ –Ω–æ–≤—ã–π —ç–∫—Ä–∞–Ω –∏–ª–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç–µ –±–∞–≥.

–•–æ—á–µ—à—å, –º–æ–≥—É: 1) —Ä–∞–∑–æ–±—Ä–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–∫—Ä–∞–Ω –ø–æ —Å—Ç—Ä–æ–∫–∞–º –∫–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `CarDetailFragment`), –∏–ª–∏ 2) –¥–æ–±–∞–≤–∏—Ç—å inline-–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ —Ñ–∞–π–ª—ã ‚Äî –Ω–∞–ø–∏—à–∏, —á—Ç–æ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—à—å ‚úçÔ∏è
